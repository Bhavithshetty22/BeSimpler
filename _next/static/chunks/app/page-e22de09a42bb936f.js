(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{1554:(e,s,t)=>{Promise.resolve().then(t.bind(t,5685))},5685:(e,s,t)=>{"use strict";t.d(s,{default:()=>es});var a=t(5155),r=t(2115),n=t(6474),i=t(9708),l=t(2085),o=t(2596),c=t(9688);function d(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,c.QP)((0,o.$)(s))}let m=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=r.forwardRef((e,s)=>{let{className:t,variant:r,size:n,asChild:l=!1,...o}=e,c=l?i.DX:"button";return(0,a.jsx)(c,{className:d(m({variant:r,size:n,className:t})),ref:s,...o})});function h(e){let{conversations:s,selectedConversation:t,onSelectConversation:r}=e;return(0,a.jsxs)("div",{className:"w-64 border-r bg-white flex flex-col h-full",children:[(0,a.jsx)("div",{className:"p-4 border-b flex items-center justify-between",children:(0,a.jsx)("h2",{className:"font-semibold text-gray-800",children:"Your inbox"})}),(0,a.jsx)("div",{className:"px-4 py-3 border-b bg-gray-50",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(u,{variant:"outline",size:"sm",className:"flex items-center h-7 text-xs",children:[(0,a.jsx)("span",{children:"5 Open"}),(0,a.jsx)(n.A,{className:"ml-1 h-3 w-3"})]}),(0,a.jsxs)(u,{variant:"outline",size:"sm",className:"flex items-center h-7 text-xs",children:[(0,a.jsx)("span",{children:"Waiting longest"}),(0,a.jsx)(n.A,{className:"ml-1 h-3 w-3"})]})]})}),(0,a.jsx)("div",{className:"overflow-y-auto flex-1",children:Object.values(s).map(e=>{let s="inbox-avatar-blue";return"ivan"===e.id&&(s="inbox-avatar-red"),"lead"===e.id&&(s="inbox-avatar-green"),"booking"===e.id&&(s="inbox-avatar-gray"),"miracle"===e.id&&(s="inbox-avatar-purple"),(0,a.jsx)("div",{className:"inbox-item ".concat(t===e.id?"active":""),onClick:()=>r(e.id),children:(0,a.jsxs)("div",{className:"flex items-start",children:[(0,a.jsx)("div",{className:"inbox-avatar ".concat(s," mr-3"),children:e.name.charAt(0)}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"font-medium text-sm",children:[e.name.split(" ")[0]," - ",e.company]}),(0,a.jsx)("div",{className:"text-xs text-gray-400",children:e.lastMessageTime})]}),(0,a.jsx)("div",{className:"text-xs text-gray-500 mt-1 truncate",children:e.lastMessage})]})]})},e.id)})})]})}u.displayName="Button";var x=t(492),f=t(9424),p=t(1154),g=t(2486);function v(e){let{message:s,isSelected:t,onSelect:n}=e,i=(0,r.useRef)(null),[l,o]=(0,r.useState)(""),c="customer"===s.sender;return"system"===s.sender?(0,a.jsx)("div",{className:"flex justify-center my-4",children:(0,a.jsxs)("div",{className:"bg-yellow-100 text-yellow-800 px-4 py-2 rounded-md text-sm",children:[s.text,(0,a.jsx)("span",{className:"text-xs text-yellow-600 ml-2",children:s.time})]})}):(0,a.jsxs)("div",{className:"flex mb-4 ".concat(c?"justify-start":"justify-end"),ref:i,children:[c&&(0,a.jsx)("img",{src:"/placeholder.svg?height=32&width=32",alt:"Customer",className:"h-8 w-8 rounded-full mr-2 mt-1"}),(0,a.jsxs)("div",{className:"max-w-[70%]",children:[(0,a.jsx)("div",{className:"p-3 rounded-lg ".concat(c?"bg-gray-100 text-gray-800":"bg-gradient-to-r from-blue-100 to-blue-50 text-blue-800 border border-blue-200"," ").concat(t?"ring-2 ring-blue-400":""),onMouseUp:()=>{let e=window.getSelection();if(e&&e.toString().length>0&&(o(e.toString()),i.current)){let e=i.current.getBoundingClientRect();n({top:e.top-40,left:e.left+e.width/2})}},children:(0,a.jsx)("p",{className:"whitespace-pre-wrap",children:s.text})}),(0,a.jsxs)("div",{className:"text-xs text-gray-500 mt-1 ".concat(c?"text-left":"text-right"),children:[s.time," ",!c&&"• Seen"]})]}),!c&&(0,a.jsx)("img",{src:"/placeholder.svg?height=32&width=32",alt:"Agent",className:"h-8 w-8 rounded-full ml-2 mt-1"})]})}var y=t(3904),b=t(1976),w=t(8071),j=t(646),N=t(7835),k=t(7434);function C(e){let{position:s,onClose:t,onSelectOption:n,isProcessing:i,processingOption:l}=e,o=(0,r.useRef)(null),c=[{id:"rephrase",label:"Rephrase",icon:y.A},{id:"friendly",label:"Make it friendlier",icon:b.A},{id:"formal",label:"Make it more formal",icon:w.A},{id:"grammar",label:"Fix grammar",icon:j.A},{id:"translate",label:"Translate",icon:N.A},{id:"summarize",label:"Summarize",icon:k.A}];return(0,r.useEffect)(()=>{let e=e=>{o.current&&!o.current.contains(e.target)&&t()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[t]),(0,a.jsx)("div",{ref:o,className:"absolute z-10 bg-white rounded-lg shadow-lg p-2 border",style:{top:"".concat(s.top,"px"),left:"".concat(s.left,"px"),transform:"translateX(-50%)"},children:(0,a.jsx)("div",{className:"flex flex-wrap gap-1 w-64",children:c.map(e=>(0,a.jsxs)(u,{variant:"outline",size:"sm",className:"flex items-center justify-start w-full hover:bg-gradient-to-r hover:from-blue-50 hover:to-purple-50",onClick:()=>n(e.id),disabled:i,children:[i&&l===e.id?(0,a.jsx)(p.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,a.jsx)(e.icon,{className:"h-4 w-4 mr-2"}),e.label]},e.id))})})}var A=t(3311),S=t(9727),I=t(9144),T=t(3417),z=t(8164),M=t(8440),R=t(2705),E=t(7213);let O={useOfflineMode:!0,mockDelay:800};async function L(e,s){if(O.useOfflineMode)return q(e,s);try{let t="";switch(s){case"rephrase":t="You are a helpful assistant. Rephrase this message in a clear, professional way while keeping the same meaning.";break;case"friendly":t="You are a friendly customer service agent. Make this message warm, approachable and friendly. Add appropriate emojis if suitable.";break;case"formal":t="You are a professional business correspondent. Make this message more formal and professional while maintaining its meaning.";break;case"grammar":t="You are a grammar expert. Fix any grammar or spelling errors in this text without changing its meaning or tone.";break;case"translate":t="You are a professional translator. Translate this message to French while preserving its meaning and tone.";break;case"tone":t="You are a tone specialist. Rewrite this message in a balanced, professional yet friendly tone suitable for customer service.";break;case"summarize":t="You are a summarization expert. Create a concise summary of this conversation that captures the key points and customer needs.";break;default:return{result:e}}try{let a=await fetch("/api/ai/gemini-proxy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,systemPrompt:t,option:s})});if(!a.ok)throw Error("Proxy API request failed with status ".concat(a.status));return{result:(await a.json()).result}}catch(t){return console.error("Proxy API failed, falling back to mock response:",t),q(e,s)}}catch(t){return console.error("Error processing with AI:",t),q(e,s)}}async function P(e,s){if(O.useOfflineMode)return D(e,s);try{try{let t="You are Fin AI Copilot, an advanced AI assistant for customer service agents.\n\nYour primary goal is to help agents provide excellent customer service by:\n1. Answering questions about company policies, products, and procedures\n2. Suggesting responses to customer inquiries\n3. Providing relevant information based on the conversation context\n4. Offering actionable next steps\n\nCurrent conversation context:\n".concat(s||"No context provided","\n\nCompany policies to keep in mind:\n- Refunds are available for items returned within 60 days of purchase\n- Items must be in original condition with packaging\n- Shipping typically takes 3-5 business days for standard, 1-2 days for express\n- Exchanges can be processed within 30 days of purchase\n\nRespond in a clear, concise, and helpful manner. Format your response with proper paragraphs and bullet points when appropriate."),a=await fetch("/api/ai/gemini-proxy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e,systemPrompt:t})});if(!a.ok)throw Error("Proxy API request failed with status ".concat(a.status));let r=(await a.json()).result;(e.toLowerCase().includes("refund")||e.toLowerCase().includes("return"))&&(r="We understand if your purchase didn't quite meet your expectations. To help you with a refund, please provide your order ID and proof of purchase.\n\nJust a heads-up:\n① We can only refund orders from the last 60 days.\n② Your item must meet our return condition requirements.\n\nOnce confirmed, I'll send you a returns QR code for easy processing.\n\nThanks for your cooperation!");let n=function(e,s){let t=e.toLowerCase(),a=s.toLowerCase(),r=["Company policies","Customer service guidelines","Product information"];return t.includes("refund")||a.includes("refund")?r=["Refund policy","Return process","Payment refunds"]:t.includes("shipping")||t.includes("delivery")||a.includes("shipping")||a.includes("delivery")?r=["Shipping policy","Delivery timeframes","Tracking information"]:t.includes("exchange")||t.includes("return")||a.includes("exchange")||a.includes("return")?r=["Exchange policy","Return process","Product exchanges"]:t.includes("order")||t.includes("purchase")||a.includes("order")||a.includes("purchase")?r=["Order management","Purchase history","Order tracking"]:(t.includes("account")||t.includes("login")||a.includes("account")||a.includes("login"))&&(r=["Account management","Login help","Password reset"]),r}(e,r);return{text:r,sources:n}}catch(t){return console.error("Proxy API failed, falling back to mock response:",t),D(e,s)}}catch(t){return console.error("Error getting AI response:",t),D(e,s)}}function q(e,s){return new Promise(t=>{setTimeout(()=>{let a="";switch(s){case"rephrase":a="We understand that sometimes a purchase may not meet your expectations, and you may need to request a refund.";break;case"friendly":a="Hey there! I totally understand that sometimes purchases don't work out as expected. We're happy to help you with a refund request! \uD83D\uDE0A";break;case"formal":a="Dear valued customer, we acknowledge that occasionally purchases may not align with expectations. In such instances, our company policy permits refund requests under specific conditions.";break;case"grammar":a=e.replace(/refund/g,"refund").replace(/please/g,"please");break;case"translate":a="Nous comprenons que parfois un achat peut ne pas r\xe9pondre \xe0 vos attentes, et vous pourriez avoir besoin de demander un remboursement.";break;case"tone":a="I understand your situation completely. Let me help you with that refund request in a friendly and efficient way.";break;case"summarize":a=e.includes("refund")?"Customer needs a refund for an unopened Christmas gift purchased in November because the recipient already has a similar item.":e.includes("tracking")?"Customer has not received their order even though tracking says it was delivered.":"Summary of the conversation: ".concat(e.substring(0,100),"...");break;default:a=e}t({result:a})},O.mockDelay)})}function D(e,s){return new Promise(s=>{setTimeout(()=>{let t="";s({text:e.toLowerCase().includes("refund")?"We understand if your purchase didn't quite meet your expectations. To help you with a refund, please provide your order ID and proof of purchase.\n\nJust a heads-up:\n① We can only refund orders from the last 60 days.\n② Your item must meet our return condition requirements.\n\nOnce confirmed, I'll send you a returns QR code for easy processing.\n\nThanks for your cooperation!":e.toLowerCase().includes("shipping")||e.toLowerCase().includes("delivery")?"For shipping inquiries, we need to verify a few details:\n\n1. Order number\n2. Shipping address\n3. Date of purchase\n\nStandard shipping typically takes 3-5 business days, while express shipping is 1-2 business days. If your package shows as delivered but you haven't received it, we recommend checking with neighbors and your local delivery office first.":e.toLowerCase().includes("exchange")?"For exchanges, our policy allows you to exchange items within 30 days of purchase. The item must be in its original condition with all tags and packaging. \n\nTo process an exchange:\n1. Provide your order number\n2. Specify which item you want to exchange and for what\n3. We'll send you a return label for the original item":"I'm here to help with your customer service needs. Based on the conversation, I can assist with:\n\n1. Processing refunds or returns\n2. Tracking orders and shipments\n3. Answering product questions\n4. Handling account issues\n\nPlease provide more details about your specific question, and I'll be happy to assist further.",sources:["Getting a refund","Refund for an order placed by mistake","Refund for an unwanted gift"]})},O.mockDelay)})}function F(e){let{position:s,selectedText:t,onClose:n,onFormatText:i}=e,[l,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)(!1),[m,h]=(0,r.useState)(null),x=(0,r.useRef)(null),f=(0,r.useRef)(null);(0,r.useEffect)(()=>{let e=e=>{x.current&&!x.current.contains(e.target)&&f.current&&!f.current.contains(e.target)&&n()};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[n]);let p=async e=>{if(t.trim()){d(!0),h(e);try{let s=await L(t,e);i(s.result,e),o(!1)}catch(e){console.error("Error processing with AI:",e)}finally{d(!1),h(null)}}},g=e=>{let s=t;switch(e){case"bold":s="**".concat(t,"**");break;case"italic":s="*".concat(t,"*");break;case"code":s="`".concat(t,"`");break;case"link":s="[".concat(t,"](url)");break;case"h1":s="# ".concat(t);break;case"h2":s="## ".concat(t)}i(s,e)};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{ref:x,className:"absolute z-50 bg-white rounded-md shadow-md flex items-center p-1 border border-gray-200",style:{top:"".concat(s.top,"px"),left:"".concat(s.left,"px"),transform:"translate(-50%, -100%)"},children:[(0,a.jsx)(u,{variant:"ghost",size:"sm",className:"p-1.5 h-8 w-8 ".concat(l?"bg-blue-100":""),onClick:()=>o(!l),children:(0,a.jsx)(A.A,{className:"h-4 w-4 text-blue-600"})}),(0,a.jsx)("div",{className:"w-px h-5 bg-gray-200 mx-1"}),(0,a.jsx)(u,{variant:"ghost",size:"sm",className:"p-1.5 h-8 w-8",onClick:()=>g("bold"),children:(0,a.jsx)(S.A,{className:"h-4 w-4"})}),(0,a.jsx)(u,{variant:"ghost",size:"sm",className:"p-1.5 h-8 w-8",onClick:()=>g("italic"),children:(0,a.jsx)(I.A,{className:"h-4 w-4"})}),(0,a.jsx)(u,{variant:"ghost",size:"sm",className:"p-1.5 h-8 w-8",onClick:()=>g("code"),children:(0,a.jsx)(T.A,{className:"h-4 w-4"})}),(0,a.jsx)(u,{variant:"ghost",size:"sm",className:"p-1.5 h-8 w-8",onClick:()=>g("link"),children:(0,a.jsx)(z.A,{className:"h-4 w-4"})}),(0,a.jsx)("div",{className:"w-px h-5 bg-gray-200 mx-1"}),(0,a.jsx)(u,{variant:"ghost",size:"sm",className:"p-1.5 h-8 w-8",onClick:()=>g("h1"),children:(0,a.jsx)(M.A,{className:"h-4 w-4"})}),(0,a.jsx)(u,{variant:"ghost",size:"sm",className:"p-1.5 h-8 w-8",onClick:()=>g("h2"),children:(0,a.jsx)(R.A,{className:"h-4 w-4"})}),(0,a.jsx)(u,{variant:"ghost",size:"sm",className:"p-1.5 h-8 w-8",children:(0,a.jsx)(E.A,{className:"h-4 w-4"})})]}),l&&(0,a.jsx)("div",{ref:f,className:"absolute z-50 bg-white rounded-md shadow-md p-1 border border-gray-200 w-48",style:{top:"".concat(s.top-40,"px"),left:"".concat(s.left,"px"),transform:"translateX(-50%)"},children:(0,a.jsx)("div",{className:"py-1",children:[{id:"rephrase",label:"Rephrase"},{id:"grammar",label:"Fix Grammar"},{id:"summarize",label:"Summarize"},{id:"formal",label:"Formal Tone"},{id:"friendly",label:"Friendly Tone"}].map(e=>(0,a.jsxs)(u,{variant:"ghost",size:"sm",className:"flex items-center justify-start w-full h-9 px-3 hover:bg-blue-50",onClick:()=>p(e.id),disabled:c,children:[c&&m===e.id?(0,a.jsx)("div",{className:"h-4 w-4 mr-2 rounded-full border-2 border-blue-600 border-t-transparent animate-spin"}):(0,a.jsx)(A.A,{className:"h-4 w-4 mr-2 text-blue-600"}),e.label]},e.id))})})]})}function Y(e){let{conversation:s,onMessageSelect:t,selectedMessage:n,aiOptions:i,onCloseAiOptions:l,onSendMessage:o,currentMessage:c,setCurrentMessage:d}=e,[m,h]=(0,r.useState)(!1),[y,b]=(0,r.useState)(!1),[w,j]=(0,r.useState)(""),[N,k]=(0,r.useState)(!1),[A,S]=(0,r.useState)(null),[I,T]=(0,r.useState)(!1),[z,M]=(0,r.useState)({top:0,left:0}),[R,E]=(0,r.useState)(""),[O,P]=(0,r.useState)(0),[q,D]=(0,r.useState)(0),Y=(0,r.useRef)(null),B=(0,r.useRef)(null),H=(0,r.useRef)(null);(0,r.useEffect)(()=>{W()},[null==s?void 0:s.messages]);let W=()=>{var e;null===(e=Y.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},U=async()=>{""!==c.trim()&&(k(!0),await new Promise(e=>setTimeout(e,300)),o(c),d(""),k(!1))},V=async e=>{if(!n||!s)return;let t=s.messages.find(e=>e.id===n);if(t){h(!0),S(e);try{if("summarize"===e){let e=await L(s.messages.map(e=>"".concat(e.sender,": ").concat(e.text)).join("\n"),"summarize");j(e.result),b(!0),l()}else{let s=await L(t.text,e);d(s.result)}l()}catch(e){console.error("Error processing with AI:",e),alert("There was an error processing your request. Using fallback responses instead.")}finally{h(!1),S(null)}}},_=()=>{if(B.current){let e=B.current.selectionStart,s=B.current.selectionEnd;if(e!==s){E(c.substring(e,s)),P(e),D(s);let t=B.current,a=c.substring(0,e).split("\n").length-1,r=t.getBoundingClientRect(),n=t.scrollTop;M({top:r.top+24*a-n,left:r.left+150}),T(!0)}else T(!1)}};return s?(0,a.jsxs)("div",{className:"flex-1 flex flex-col h-full overflow-hidden relative bg-white",children:[y&&(0,a.jsxs)("div",{className:"absolute top-4 left-1/2 transform -translate-x-1/2 bg-white p-4 rounded-lg shadow-lg z-10 max-w-md border border-gray-200",children:[(0,a.jsx)("h3",{className:"font-medium mb-2",children:"Conversation Summary"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:w}),(0,a.jsx)(u,{variant:"outline",size:"sm",className:"mt-2",onClick:()=>b(!1),children:"Close"})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 relative",ref:H,children:[s.messages.map(e=>(0,a.jsx)(v,{message:e,isSelected:n===e.id,onSelect:s=>t(e.id,s)},e.id)),(0,a.jsx)("div",{ref:Y})]}),i&&i.visible&&(0,a.jsx)(C,{position:i.position,onClose:l,onSelectOption:V,isProcessing:m,processingOption:A}),I&&(0,a.jsx)(F,{position:z,selectedText:R,onClose:()=>T(!1),onFormatText:(e,s)=>{B.current&&(d(c.substring(0,O)+e+c.substring(q)),T(!1),setTimeout(()=>{if(B.current){B.current.focus();let s=O+e.length;B.current.setSelectionRange(s,s)}},0))}}),(0,a.jsx)("div",{className:" p-4 ",children:(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsxs)("div",{className:"flex-1 border rounded-md shadow-sm bg-white",children:[(0,a.jsx)("div",{className:"flex items-center px-3 py-2 bg-gray-50 text-xs text-gray-500 border-b",children:(0,a.jsx)("span",{className:"mr-3 text-base font-bold",children:"Chat"})}),(0,a.jsx)("textarea",{ref:B,className:"w-full p-3 focus:outline-none resize-none min-h-[100px]",placeholder:"Type your message...",rows:3,value:c,onChange:e=>d(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),U())},onMouseUp:_,onKeyUp:_,disabled:N||m}),(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 border-t",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(u,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,a.jsx)(x.A,{className:"h-4 w-4"})}),(0,a.jsx)(u,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,a.jsx)(f.A,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(u,{variant:"outline",size:"sm",children:"Save draft"}),(0,a.jsx)(u,{onClick:U,className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white hover:from-blue-700 hover:to-purple-700",disabled:""===c.trim()||N||m,children:N?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(p.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending..."]}):(0,a.jsxs)(a.Fragment,{children:["Send",(0,a.jsx)(g.A,{className:"ml-2 h-4 w-4"})]})})]})]})]})})})]}):(0,a.jsx)("div",{className:"flex-1 flex items-center justify-center bg-gray-50",children:(0,a.jsx)("p",{className:"text-gray-500",children:"Select a conversation to start chatting"})})}var B=t(7768);let H=B.bL,W=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(B.B8,{ref:s,className:d("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...r})});W.displayName=B.B8.displayName;let U=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(B.l9,{ref:s,className:d("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...r})});U.displayName=B.l9.displayName;let V=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(B.UC,{ref:s,className:d("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...r})});V.displayName=B.UC.displayName;var _=t(2138),G=t(9881),K=t(3786),J=t(3052);function Q(e){let{conversation:s,onAddToComposer:t}=e,[i,l]=(0,r.useState)(""),[o,c]=(0,r.useState)([]),[d,m]=(0,r.useState)(!1),[h,x]=(0,r.useState)([]),[f,g]=(0,r.useState)(null),[v,y]=(0,r.useState)(!1),b=(0,r.useRef)(null),w=(0,r.useRef)(null),[j,N]=(0,r.useState)(!1),[k,C]=(0,r.useState)(O.useOfflineMode);(0,r.useEffect)(()=>{S()},[o]);let S=()=>{var e;null===(e=b.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},I=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i;if(!e.trim()||!s)return;let t={id:"q".concat(o.length+1),sender:"user",text:e,type:"question"};c([...o,t]),l(""),m(!0);try{let t=s.messages.map(e=>"".concat(e.sender,": ").concat(e.text)).join("\n"),a=await P(e,t),r=a.text;(e.toLowerCase().includes("refund")||e.toLowerCase().includes("return"))&&(r="Please note:\nWe can only refund orders placed within the last 60 days, and your item must meet our requirements for condition to be returned. Please check when you placed your order before proceeding.\n\nOnce I've checked these details, if everything looks OK, I will send a returns QR code which you can use to post the item back to us. Your refund will be automatically issued once you put it in the post.");let n={id:"a".concat(o.length+1),sender:"copilot",text:r,type:"answer"};c(e=>[...e,n]),x(a.sources||["Getting a refund","Refund for an order placed by mistake","Refund for an unwanted gift"]),y(!1)}catch(s){console.error("Error getting AI response:",s),y(!0);let e={id:"a".concat(o.length+1),sender:"copilot",text:"I'm sorry, I couldn't process your request with the Gemini API. Using stored responses instead.",type:"answer"};c(s=>[...s,e])}finally{m(!1)}},T=e=>{t&&(t(e),g(e),setTimeout(()=>{g(null)},2e3))};return s?(0,a.jsx)("div",{className:"w-full h-full border-l bg-white flex flex-col",children:(0,a.jsxs)(H,{defaultValue:"copilot",className:"flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"flex items-center border-b",children:[(0,a.jsx)("div",{className:"flex-1 flex",children:(0,a.jsxs)(W,{className:"bg-transparent p-0",children:[(0,a.jsxs)(U,{value:"copilot",className:"flex items-center px-4 py-3 data-[state=active]:tab-active data-[state=inactive]:tab-inactive border-b-2 border-transparent",children:[(0,a.jsx)("div",{className:"bg-indigo-600 text-white p-1 rounded mr-2",children:(0,a.jsx)(A.A,{className:"h-3 w-3"})}),"AI Copilot"]}),(0,a.jsx)(U,{value:"details",className:"px-4 py-3 data-[state=active]:tab-active data-[state=inactive]:tab-inactive border-b-2 border-transparent",children:"Details"})]})}),(0,a.jsx)(u,{variant:"ghost",size:"sm",className:"h-8 w-8 p-0 mr-2",children:(0,a.jsxs)("svg",{width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,a.jsx)("path",{d:"M7.5 1.5C4.5 1.5 2 4 2 7C2 10 4.5 12.5 7.5 12.5C10.5 12.5 13 10 13 7C13 4 10.5 1.5 7.5 1.5ZM7.5 11.5C5 11.5 3 9.5 3 7C3 4.5 5 2.5 7.5 2.5C10 2.5 12 4.5 12 7C12 9.5 10 11.5 7.5 11.5Z",fill:"currentColor"}),(0,a.jsx)("path",{d:"M6.5 5C6.5 5.55228 6.94772 6 7.5 6C8.05228 6 8.5 5.55228 8.5 5C8.5 4.44772 8.05228 4 7.5 4C6.94772 4 6.5 4.44772 6.5 5Z",fill:"currentColor"}),(0,a.jsx)("path",{d:"M6.5 9V7H8.5V9H6.5Z",fill:"currentColor"})]})})]}),(0,a.jsxs)(V,{value:"copilot",className:"flex-1 flex flex-col overflow-hidden p-0",style:{background:"\n    radial-gradient(circle at bottom left, rgba(255, 0, 0, 0.15) 5%, transparent 30%),\n    radial-gradient(circle at bottom right, rgba(128, 0, 128, 0.15) 5%, transparent 30%),\n    white"},children:[(0,a.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===o.length?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center p-4",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-full bg-gray-800 flex items-center justify-center text-white mb-4",children:(0,a.jsx)(A.A,{className:"h-5 w-5"})}),(0,a.jsx)("h3",{className:"font-medium",children:"Hi, I'm Fin AI Copilot"}),(0,a.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Ask me anything about this conversation."})]}):(0,a.jsxs)("div",{className:"p-4 space-y-6",children:[o.map((e,s)=>(0,a.jsx)("div",{className:"flex flex-col animate-fadeIn",children:(0,a.jsx)("div",{className:"flex items-start mb-2",children:"user"===e.sender?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 mr-2 flex-shrink-0",children:(0,a.jsx)("img",{src:"/placeholder.svg?height=32&width=32",alt:"You",className:"rounded-full"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:"You"}),(0,a.jsx)("div",{className:"text-sm bg-gray-100 p-3 rounded-lg",children:e.text})]})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 mr-2 flex-shrink-0 flex items-center justify-center text-white",children:(0,a.jsx)(A.A,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:"Fin"}),(0,a.jsxs)("div",{className:"finn-message-gradient p-4 rounded-lg text-sm border border-purple-100 whitespace-pre-wrap leading-relaxed relative",children:[e.text.split("\n\n").map((e,s)=>(0,a.jsx)("p",{className:s>0?"mt-3":"",children:e.includes("①")?(0,a.jsx)(a.Fragment,{children:e.split("\n").map((e,s)=>(0,a.jsx)("div",{className:s>0?"mt-1":"",children:e.includes("①")?(0,a.jsxs)("span",{children:[e.replace("①","")," ",(0,a.jsx)("span",{className:"inline-flex items-center justify-center w-5 h-5 rounded-full bg-blue-500 text-white text-xs",children:"1"})]}):e.includes("②")?(0,a.jsxs)("span",{children:[e.replace("②","")," ",(0,a.jsx)("span",{className:"inline-flex items-center justify-center w-5 h-5 rounded-full bg-blue-500 text-white text-xs",children:"2"})]}):e},s))}):e},s)),(0,a.jsx)("div",{className:"mt-3 border-t border-purple-100 pt-2",children:(0,a.jsxs)(u,{variant:"outline",size:"sm",className:"flex items-center text-sm transition-all duration-200 hover:bg-blue-50 w-full justify-between bg-white",onClick:()=>T(e.text),children:[(0,a.jsxs)("span",{className:"flex items-center",children:[(0,a.jsx)("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"mr-1.5",children:(0,a.jsx)("path",{d:"M8 8H16M8 12H16M8 16H12M19 3H5C3.89543 3 3 3.89543 3 5V19C3 20.1046 3.89543 21 5 21H19C20.1046 21 21 20.1046 21 19V5C21 3.89543 20.1046 3 19 3Z",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}),"Add to composer"]}),(0,a.jsx)(n.A,{className:"h-3 w-3"})]})})]}),s===o.length-1&&"copilot"===e.sender&&h.length>0&&(0,a.jsxs)("div",{className:"mt-3 text-sm text-gray-600",children:[(0,a.jsxs)("div",{className:"text-xs text-gray-500 mb-1",children:[h.length," relevant sources found"]}),(0,a.jsx)("ul",{className:"space-y-1",children:h.slice(0,3).map((e,s)=>(0,a.jsxs)("li",{className:"flex items-start",children:[(0,a.jsx)("span",{className:"inline-flex items-center justify-center w-4 h-4 rounded-sm bg-gray-200 text-gray-700 text-xs mr-2 mt-0.5",children:"■"}),e]},s))}),h.length>3&&(0,a.jsxs)("button",{className:"text-xs text-gray-500 mt-1 flex items-center hover:text-gray-700",children:["See all ",(0,a.jsx)(_.A,{className:"h-3 w-3 ml-1"})]})]})]})]})})},e.id)),d&&(0,a.jsxs)("div",{className:"flex items-start animate-fadeIn",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-r from-blue-600 to-purple-600 mr-2 flex-shrink-0 flex items-center justify-center text-white",children:(0,a.jsx)(A.A,{className:"h-4 w-4"})}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium text-sm",children:"Fin"}),(0,a.jsxs)("div",{className:"finn-message-gradient p-3 rounded-lg flex items-center justify-center h-20 border border-purple-100",children:[(0,a.jsx)(p.A,{className:"h-5 w-5 text-purple-500 animate-spin"}),(0,a.jsx)("span",{className:"ml-2 text-sm text-purple-700",children:"Thinking..."})]})]})]}),(0,a.jsx)("div",{ref:b})]})}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsx)("div",{className:"relative",children:(0,a.jsxs)("div",{className:"bg-gray-100 rounded-md flex items-center",children:[(0,a.jsx)("input",{ref:w,type:"text",placeholder:"Ask a follow up question...",className:"w-full p-3 bg-transparent border-none focus:outline-none text-sm",value:i,onChange:e=>l(e.target.value),onKeyDown:e=>{"Enter"===e.key&&I()}}),(0,a.jsx)(u,{className:"h-8 w-8 mr-2 p-0 bg-transparent hover:bg-transparent",onClick:()=>I(),disabled:!i.trim()||d,children:d?(0,a.jsx)(p.A,{className:"h-4 w-4 animate-spin text-gray-500"}):(0,a.jsx)(G.A,{className:"h-4 w-4 text-gray-500"})})]})})})]}),(0,a.jsx)(V,{value:"details",className:"flex-1 overflow-y-auto p-4",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("span",{className:"text-sm font-medium mr-2",children:"Assignee"})}),(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("img",{src:"/placeholder.svg?height=24&width=24",alt:"Brian Byrne",className:"w-6 h-6 rounded-full mr-1"}),(0,a.jsx)("span",{className:"text-sm",children:"Brian Byrne"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"text-sm font-medium",children:"Team"}),(0,a.jsx)("span",{className:"text-sm",children:"Unassigned"})]}),(0,a.jsxs)("div",{className:"pt-4 border-t",children:[(0,a.jsx)("h3",{className:"font-medium mb-3 text-xs text-gray-500",children:"LINKS"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(K.A,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,a.jsx)("span",{className:"text-sm",children:"Tracker ticket"})]}),(0,a.jsx)(u,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 transition-all duration-200",children:"+"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(K.A,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,a.jsx)("span",{className:"text-sm",children:"Back-office tickets"})]}),(0,a.jsx)(u,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 transition-all duration-200",children:"+"})]}),(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)(K.A,{className:"h-4 w-4 mr-2 text-gray-400"}),(0,a.jsx)("span",{className:"text-sm",children:"Side conversations"})]}),(0,a.jsx)(u,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 transition-all duration-200",children:"+"})]})]})]}),(0,a.jsx)("div",{className:"pt-4 border-t",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"font-medium text-xs text-gray-500",children:"USER DATA"}),(0,a.jsx)(J.A,{className:"h-4 w-4"})]})}),(0,a.jsx)("div",{className:"pt-4 border-t",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("h3",{className:"font-medium text-xs text-gray-500",children:"CONVERSATION ATTRIBUTES"}),(0,a.jsx)(J.A,{className:"h-4 w-4"})]})})]})})]})}):(0,a.jsx)("div",{className:"w-full h-full border-l bg-white flex flex-col",children:(0,a.jsx)("div",{className:"p-4 text-center text-gray-500",children:"Select a conversation to use AI Copilot"})})}var Z=t(5623),X=t(3509);function $(e){let{conversationId:s,conversation:t,onCloseConversation:r}=e;return t?(0,a.jsxs)("div",{className:"h-14 border-b bg-white flex items-center justify-between px-4",children:[(0,a.jsx)("div",{className:"flex items-center",children:(0,a.jsx)("h1",{className:"text-xl font-bold",children:t.name})}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(u,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,a.jsx)(Z.A,{className:"h-5 w-5"})}),(0,a.jsx)(u,{variant:"ghost",size:"icon",className:"h-8 w-8",children:(0,a.jsx)(X.A,{className:"h-5 w-5"})}),(0,a.jsx)(u,{variant:"secondary",size:"sm",className:"bg-gray-900 text-white hover:bg-gray-800 h-8 px-3",onClick:r,children:"Close"})]})]}):null}let ee={luis:{id:"luis",name:"Luis Easton",company:"Github",email:"luis@github.com",avatar:"/placeholder.svg?height=40&width=40",lastMessage:"I need a refund for a product...",lastMessageTime:"45m",unread:!1,messages:[{id:"msg1",sender:"customer",text:"I bought a product from your store in November as a Christmas gift for a member of my family. However, it turns out they have something very similar already. I was hoping you'd be able to refund me, as it is un-opened.",time:"10:00"},{id:"msg2",sender:"agent",text:"Let me just look into this for you, Luis...",time:"10:05"}]},ryan:{id:"ryan",name:"Ryan",company:"Nike",email:"ryan@nike.com",avatar:"/placeholder.svg?height=40&width=40",lastMessage:"Hi there, I have a question...",lastMessageTime:"2h",unread:!0,messages:[{id:"msg1",sender:"customer",text:"Hi there, I have a question about my recent order. The tracking says it was delivered, but I haven't received anything yet.",time:"09:30"}]},lead:{id:"lead",name:"Lead from New York",company:"",email:"lead@example.com",avatar:"/placeholder.svg?height=40&width=40",lastMessage:"Good morning, sir! How are...",lastMessageTime:"3h",unread:!1,messages:[{id:"msg1",sender:"customer",text:"Good morning, sir! How are your products manufactured? I'm interested in bulk ordering for my company in New York.",time:"08:15"}]},booking:{id:"booking",name:"Booking API problems",company:"Bug report",email:"luke@smallcrafty.com",avatar:"/placeholder.svg?height=40&width=40",lastMessage:"Luke - Small Crafty",lastMessageTime:"45m",unread:!1,messages:[{id:"msg1",sender:"customer",text:"We're experiencing issues with the booking API. Our customers can't complete their reservations and we're losing business.",time:"09:45"}]},miracle:{id:"miracle",name:"Miracle",company:"Exemplary Bank",email:"miracle@exemplarybank.com",avatar:"/placeholder.svg?height=40&width=40",lastMessage:"Hey there, I'm here to...",lastMessageTime:"48m",unread:!1,messages:[{id:"msg1",sender:"customer",text:"Hey there, I'm here to inquire about integrating your payment system with our banking platform. Do you have an API we can use?",time:"09:22"}]},nikola:{id:"nikola",name:"Nikola Tesla",company:"Tesla Inc",email:"nikola@tesla.com",avatar:"/placeholder.svg?height=40&width=40",lastMessage:"I placed the order over 60 days ago...",lastMessageTime:"21m",unread:!1,messages:[{id:"msg1",sender:"agent",text:"Thanks, passing you to the right team now.",time:"10:10"},{id:"msg2",sender:"agent",text:"Let me just look into this for you, Nikola.",time:"10:15"},{id:"msg3",sender:"agent",text:"We understand if your purchase didn't quite meet your expectations. To help you with a refund, please provide your order ID and proof of purchase.\n\nJust a heads-up:\nWe can only refund orders from the last 60 days.\nYour item must meet our return condition requirements.\n\nOnce confirmed, I'll send you a returns QR code for easy processing.\n\nThanks for your cooperation!",time:"10:20"},{id:"msg4",sender:"customer",text:"I placed the order over 60 days ago \uD83D\uDE14. Could you make an exception, please?",time:"10:21"},{id:"msg5",sender:"system",text:"This customer has been waiting for 5 minutes.",time:"10:16"}]}};function es(){let[e,s]=(0,r.useState)("luis"),[t,n]=(0,r.useState)(null),[i,l]=(0,r.useState)(null),[o,c]=(0,r.useState)(ee),[d,m]=(0,r.useState)(""),[u,x]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{let e=()=>{x(window.innerWidth<768)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]),(0,a.jsxs)("div",{className:"flex h-screen overflow-hidden bg-gray-50",children:[(0,a.jsx)(h,{conversations:o,selectedConversation:e,onSelectConversation:e=>{s(e)}}),(0,a.jsxs)("div",{className:"flex flex-col flex-1 overflow-hidden relative",children:[(0,a.jsx)($,{conversationId:e,conversation:o[e],onToggleLeftSidebar:()=>{},onToggleRightSidebar:()=>{},leftSidebarOpen:!0,rightSidebarOpen:!0,onCloseConversation:()=>{let t=Object.keys(o),a=t.indexOf(e);if(t.length>1){let e=(a+1)%t.length;s(t[e])}}}),(0,a.jsxs)("div",{className:"flex flex-1 overflow-hidden relative",children:[(0,a.jsx)(Y,{conversation:o[e],onMessageSelect:(e,s)=>{n(e),l({visible:!0,position:s,messageId:e})},selectedMessage:t,aiOptions:i,onCloseAiOptions:()=>{l(null),n(null)},onSendMessage:s=>{if(!s.trim())return;let t={...o},a=t[e];a&&(a.messages.push({id:"msg".concat(a.messages.length+1),sender:"agent",text:s,time:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})}),a.lastMessage=s,a.lastMessageTime=new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),c(t))},currentMessage:d,setCurrentMessage:m}),(0,a.jsx)("div",{className:"w-[400px] h-full",children:(0,a.jsx)(Q,{conversation:o[e],onAddToComposer:e=>{m(e)}})})]})]})]})}}},e=>{var s=s=>e(e.s=s);e.O(0,[199,441,684,358],()=>s(1554)),_N_E=e.O()}]);